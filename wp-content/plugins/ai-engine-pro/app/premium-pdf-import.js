"use strict";(self.wpJsonMwai=self.wpJsonMwai||[]).push([[115],{9473:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var l=n(9794),a=n(9296),r=n(7213),o=n(6734),i=n(4547),s=n(8514),c=n(4977),d=n(209),g=n(5484),m=n(851),u=n(7494),h=n(8051),p=n(3896),f=n(2564),y=n(8135),k=n(5658),R=n(5263),E=n(8696);const{useState:b}=wp.element,C=({chunk:e,viewMode:t,onToggle:n,onUpdateTitle:l,onGenerateTitle:r,isChunkBusy:o,isAnyChunkBusy:i,isGeneratingTitles:s,isUploadingEmbeddings:c,colors:d})=>{const[g,m]=b(!1),u=!e.enabled||o||c,h=!e.enabled||s||c;return React.createElement("div",{style:{marginBottom:10}},React.createElement("div",{style:{display:"flex",alignItems:"flex-start",gap:10}},React.createElement(R.R,{checked:e.enabled,onChange:()=>n(e.id),disabled:o||c}),React.createElement("div",{style:{flex:1}},React.createElement("div",{style:{display:"flex",alignItems:"center",gap:8}},React.createElement(E.A,{value:e.title,onChange:t=>l(e.id,t),style:{flex:1},disabled:u,placeholder:"Enter section title..."}),e.enabled&&React.createElement(a.M,{size:"small",className:"primary",ai:!0,onClick:()=>r(e),disabled:h,isBusy:o,title:"Generate AI title"},"Generate")),e.enabled&&React.createElement("div",{style:{fontSize:12,color:d.grey,marginTop:2,display:"flex",gap:5,alignItems:"center"}},React.createElement("span",null,e.pageRange),React.createElement("span",null,"•"),React.createElement("span",null,e.chars||e.content.length," chars"),React.createElement("span",null,"•"),React.createElement("button",{onClick:()=>m(!g),style:{background:"none",border:"none",color:d.primary,cursor:"pointer",padding:0,fontSize:12,textDecoration:"underline"}},g?"Hide":"View")),("detailed"===t||g)&&React.createElement("div",{style:{color:d.darkGrey,marginTop:8,marginBottom:8,maxHeight:g?"none":80,overflow:g?"auto":"hidden",lineHeight:1.5,position:"relative",padding:g?"10px":0,backgroundColor:g?d.lightGrey:"transparent",borderRadius:g?"4px":0,fontSize:g?13:14,whiteSpace:g?"pre-wrap":"normal"}},g?e.content:e.content.substring(0,200),!g&&e.content.length>200&&React.createElement("span",{style:{position:"absolute",bottom:0,right:0,background:`linear-gradient(to right, transparent, ${d.lightGrey})`,padding:"0 10px"}},"...")))))};var x=n(2714);const v=e=>Math.ceil(e.length/4),w=e=>{const t=e.split(/(?<=[.!?])\s+/).filter((e=>e.length>0)),n=[];for(const e of t)if(e.length>500){const t=e.split(/(?<=[,;])\s+/);n.push(...t)}else n.push(e);return n},P=(e,t,n)=>{let l=0,a=0;for(let r=n-1;r>=0&&l<e;r--)l+=v(t[r]),a++;return a},D=(e,t,n)=>{var l;const a=n.replace(/\.[^/.]+$/,""),r=e.split("\n").filter((e=>e.trim().length>0));for(const e of r.slice(0,5)){const t=e.trim();if(t.length>10&&t.length<100&&(/^(Chapter|Section|Part)\s+\d+/i.test(t)||/^\d+\.\s+/.test(t)||t===t.toUpperCase()||t.endsWith(":"))){if(t.length>48){let e=t.substring(0,48);return e=e.replace(/[.,;:()[\]{}\"'\s]+$/,""),e.trim()+"..."}return t}}let o=(null===(l=r[0])||void 0===l?void 0:l.substring(0,48))||`${a} - Part ${t+1}`;return o=o.replace(/\s+/g," ").trim(),r[0]&&r[0].length>48&&(o=o.replace(/[.,;:()[\]{}\"'\s]+$/,""),o=o.trim()+"..."),o},F=(e,t)=>{if(!t||0===t.length)return"";const n=e.substring(0,50).trim();for(let l=0;l<t.length;l++)if(t[l].includes(n)){const n=e.substring(Math.max(0,e.length-50)).trim();for(let e=l;e<Math.min(l+3,t.length);e++)if(t[e].includes(n))return l===e?`Page ${l+1}`:`Pages ${l+1}-${e+1}`;return`Page ${l+1}`}return""},S=async(e,t,n,l,a,r)=>{const o=[],i=w(e),s={1:2e3,2:1e3,3:500,4:400,5:200}[n]||500,c=Math.floor(s*(l/100));let d="",g=0,m=[],u=0,h=0,p=Date.now(),f=0;for(console.log(`[Client Chunking] Starting with density ${n}, chunk size ${s}, overlap ${l}%`),console.log(`[Client Chunking] Processing ${i.length} sentences`);h<i.length;){const e=i[h],n=v(e);if(g+n>s&&d.length>0){const e=D(d,u,a),n=F(d,t);o.push({title:e,content:d.trim(),chars:d.trim().length,tokens:g,pageRange:n}),f=h;const l=P(c,i,h),s=Math.max(f-Math.min(l,m.length-1),f-3);d="",g=0,m=[];for(let e=s;e<f;e++){const t=i[e];d+=t+" ",g+=v(t),m.push(t)}h=f,u++,(u%10==0||Date.now()-p>50)&&(r&&r(u,Math.floor(h/i.length*100)),console.log(`[Client Chunking] Created ${u} chunks...`),await new Promise((e=>setTimeout(e,0))),p=Date.now())}else d+=e+" ",g+=n,m.push(e),h++}if(d.trim().length>0){const e=D(d,u,a),n=F(d,t);o.push({title:e,content:d.trim(),chars:d.trim().length,tokens:g,pageRange:n})}return console.log(`[Client Chunking] Completed: ${o.length} chunks created`),o},$=(e,t,n,l)=>{const a=[];if(!n||0===n.length)return console.log("[Client Chunking] No headings detected, falling back to smart chunking"),((e,t,n,l,a)=>{console.warn("[Client Chunking] Using synchronous chunking - consider using smartTextChunkingAsync for better performance");const r=[],o=w(e),i={1:2e3,2:1e3,3:500,4:400,5:200}[n]||500,s=Math.floor(i*(l/100));let c="",d=0,g=[],m=0,u=0,h=0;for(console.log(`[Client Chunking] Starting with density ${n}, chunk size ${i}, overlap ${l}%`);u<o.length;){const e=o[u],n=v(e);if(d+n>i&&c.length>0){const e=D(c,m,a),n=F(c,t);r.push({title:e,content:c.trim(),chars:c.trim().length,tokens:d,pageRange:n}),h=u;const l=P(s,o,u),i=Math.max(h-Math.min(l,g.length-1),h-3);c="",d=0,g=[];for(let e=i;e<h;e++){const t=o[e];c+=t+" ",d+=v(t),g.push(t)}u=h,m++,m%10==0&&console.log(`[Client Chunking] Created ${m} chunks...`)}else c+=e+" ",d+=n,g.push(e),u++}if(c.trim().length>0){const e=D(c,m,a),n=F(c,t);r.push({title:e,content:c.trim(),chars:c.trim().length,tokens:d,pageRange:n})}return console.log(`[Client Chunking] Completed: ${r.length} chunks created`),r})(e,t,3,15,l);const r=[...n].sort(((e,t)=>e.pageIndex!==t.pageIndex?e.pageIndex-t.pageIndex:e.lineIndex-t.lineIndex));console.log(`[Client Chunking] Using ${r.length} detected chapters`);const o=e.split("\n");let i="",s=l;for(let e=0;e<r.length;e++){const n=r[e],l=r[e+1];let c=o.findIndex((e=>e.includes(n.text))),d=l?o.findIndex((e=>e.includes(l.text))):o.length;if(-1!==c){i=o.slice(c,d).join("\n"),s=n.text.substring(0,60);const e=F(i,t);a.push({title:s,content:i.trim(),chars:i.trim().length,tokens:v(i),pageRange:e})}}return console.log(`[Client Chunking] Created ${a.length} chapter-based chunks`),a},{useState:I,useRef:T,useMemo:M,useEffect:N,forwardRef:z,useImperativeHandle:B}=wp.element;let U=null;const A=z((({onAddEmbedding:e,environment:t,onClose:R,onError:E,onBusyChange:b},v)=>{const{colors:w}=(0,f.z)(),P=T(null),[D,F]=I(null),[z,A]=I(null),[H,G]=I([]),[_,j]=I([]),[W,O]=I(!1),[L,Y]=I(null),[V,X]=I(0),[q,J]=I(0),[Z,K]=I(""),[Q,ee]=I(!1),[te,ne]=I(!1),le=T(!1),[ae,re]=I(new Set),oe=(0,k.zM)(),[ie,se]=I(!1),[ce,de]=I((()=>localStorage.getItem("mwai_pdf_title_instructions")||"")),[ge,me]=I(3),[ue,he]=I("tokens"),[pe,fe]=I(15),ye=M((()=>_.filter((e=>e.enabled)).length),[_]);N((()=>{b&&b(W||Q)}),[W,Q,b]),N((()=>{E&&E(L)}),[L,E]),B(v,(()=>({pdfData:z,enabledCount:ye,clearPDF:we,handleUploadEmbeddings:Pe,uploadProgress:oe.percentage,busy:W})),[z,ye,oe.percentage,W,_]);const ke=e=>{const t=[];let n=null,l=[];const a=[];var r,o;(e.items.forEach((e=>{if(null===n||Math.abs(e.transform[5]-n)>2){var t,r;if(l.length>0)a.push({text:l.map((e=>e.str)).join(" ").trim(),items:l,y:n,height:(null===(t=l[0])||void 0===t?void 0:t.height)||0,fontName:(null===(r=l[0])||void 0===r?void 0:r.fontName)||""});l=[e],n=e.transform[5]}else l.push(e)})),l.length>0)&&a.push({text:l.map((e=>e.str)).join(" ").trim(),items:l,y:n,height:(null===(r=l[0])||void 0===r?void 0:r.height)||0,fontName:(null===(o=l[0])||void 0===o?void 0:o.fontName)||""});const i=a.reduce(((e,t)=>e+t.height),0)/a.length;return a.forEach(((e,n)=>{const l=e.text,a=e.height>1.2*i,r=l.split(" ").length<=10,o=/^(Chapter\s+\d+|CHAPTER\s+\d+|\d+\.|Part\s+\d+|Section\s+\d+)/i.test(l),s=l===l.toUpperCase()&&l.length>3,c=l.endsWith(":");l.length>3&&(a&&r||o||s&&r||c&&r)&&t.push({text:l,pageIndex:0,lineIndex:n,confidence:(a?.3:0)+(o?.4:0)+(s?.2:0)+(c?.1:0)})})),t.filter((e=>e.confidence>=.3))},Re=async e=>{const t=e.target.files[0];if(t&&t.type.includes("pdf")){console.log("[PDF Import] File selected:",t.name,"Size:",t.size),F(t),Y(null),O(!0);try{console.log("[PDF Import] Starting PDF parsing...");const e=await(async()=>(U||(U=await n.e(546).then(n.bind(n,1100)),U.GlobalWorkerOptions.workerSrc=`${x.Hm}/premium/pdf.worker.min.js`),U))(),l=await t.arrayBuffer(),a=await e.getDocument({data:l}).promise;console.log("[PDF Import] PDF loaded, pages:",a.numPages);let r="";const o=[],i=[];for(let e=1;e<=a.numPages;e++){console.log(`[PDF Import] Extracting text from page ${e}/${a.numPages}`);const t=await a.getPage(e),n=await t.getTextContent();ke(n).forEach((t=>{t.pageIndex=e-1,i.push(t)}));const l=n.items.map((e=>e.str)).join(" ");o.push(l),r+=l+"\n\n",J(e),X(e/a.numPages*100)}const s=r.split(/\s+/).filter((e=>e.length>0)).length;console.log("[PDF Import] Text extraction complete. Words:",s,"Characters:",r.length),console.log("[PDF Import] Detected headings:",i.length);const c={numPages:a.numPages,wordCount:s,fullText:r,pageTexts:o,fileName:t.name,detectedHeadings:i.length>=3?i:[]};A(c),await Ee(r,o,ge,c,pe)}catch(e){console.error("[PDF Import] PDF parsing error:",e),Y("Failed to parse PDF: "+e.message)}finally{O(!1)}}else Y("Please select a valid PDF file")},Ee=async(e,t,n,l,a=15)=>{O(!0),Y(null),K("analyzing"),console.log("[PDF Import] Starting client-side chunking with density:",n,"overlap:",a+"%");try{let r;if(setTimeout((()=>{W&&K("processing")}),100),console.log("[PDF Import] Using smart text chunking with density:",n),r=await S(e,t,n,a,l.fileName,((e,t)=>{K(`Creating chunks... ${e} created (${t}%)`)})),!(r&&r.length>0))throw new Error("No chunks were generated");console.log("[PDF Import] Generated chunks:",r.length),G(r),j(r.map(((e,t)=>({...e,id:`chunk_${t}`,enabled:!0})))),Y(null)}catch(e){console.error("[PDF Import] Chunking error:",e),Y("Failed to generate chunks: "+e.message)}finally{O(!1),K("")}},be=async(e,t="tokens",n=10)=>{O(!0),Y(null),console.log(`[Chunk Regeneration] Starting with density: ${e}, overlap: ${n}%`);try{let l;"chapters"===t&&z.detectedHeadings&&z.detectedHeadings.length>=3?(console.log("[Chunk Regeneration] Using chapter-based chunking"),l=$(z.fullText,z.pageTexts,z.detectedHeadings,z.fileName)):(console.log("[Chunk Regeneration] Using token-based chunking"),l=await S(z.fullText,z.pageTexts,e,n,z.fileName,((e,t)=>{K(`Regenerating... ${e} chunks (${t}%)`)}))),l&&l.length>0&&(console.log(`[Chunk Regeneration] Generated ${l.length} chunks`),G(l),j(l.map(((e,t)=>({...e,id:`chunk_${t}`,enabled:!0})))))}catch(e){console.error("[Chunk Regeneration] Error:",e),Y("Failed to regenerate chunks: "+e.message)}finally{O(!1),K("")}},Ce=e=>{j((t=>t.map((t=>t.id===e?{...t,enabled:!t.enabled}:t))))},xe=(e,t)=>{j((n=>n.map((n=>n.id===e?{...n,title:t}:n))))},ve=async e=>{console.log("[PDF Import] Generating title for chunk:",e.id),re((t=>new Set(t).add(e.id)));try{let t=0;if(_.findIndex((t=>t.id===e.id))>0&&pe>0){const n=Math.floor(e.content.length*(pe/100));t=Math.min(n,e.content.length/4)}let n=`Create a concise title (max 50 chars) for this text:\n\n${e.content.substring(t,t+1024)}`;ce&&(n+=`\n\nAdditional instructions: ${ce}`),n+="\n\nReply with ONLY the title:";const l=await(0,y.IU)(`${x.y0}/ai/completions`,{method:"POST",nonce:x.ok,json:{message:n,scope:"embeddings-title"}});if(l.success&&l.data){const t=l.data.replace(/^["']|["']$/g,"").replace(/^Title:\s*/i,"").trim().substring(0,60);xe(e.id,t)}}catch(t){console.error("[PDF Import] Error generating title:",t);let n=e.content.substring(0,48);n=n.replace(/[.,;:()[\]{}\"'\s]+$/,""),n=n.trim()+"...",xe(e.id,n)}finally{re((t=>{const n=new Set(t);return n.delete(e.id),n}))}},we=()=>{F(null),A(null),G([]),j([]),X(0),J(0),Y(null),oe.reset(),re(new Set),ee(!1),ne(!1),le.current=!1,P.current&&(P.current.value="")},Pe=async()=>{const n=_.filter((e=>e.enabled));if(0===n.length)return void Y("Please select at least one chunk to upload");oe.startPreparing(),O(!0),Y(null),await new Promise((e=>setTimeout(e,10)));const l=n.map((n=>(0,k.UT)((async l=>{const a={title:n.title||"Untitled",content:n.content,envId:null==t?void 0:t.id,status:"ok"};return await e(a,!0),{success:!0}}))));try{const e=await oe.processTasks(l);e.errors.length>0&&Y(`Failed to upload ${e.errors.length} embeddings`)}catch(e){console.error("Upload error:",e),Y("Failed to upload embeddings: "+e.message)}finally{O(!1)}};return React.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1}},React.createElement("input",{ref:P,type:"file",accept:".pdf",onChange:Re,style:{display:"none"},disabled:W}),React.createElement(i.Y,{minimal:!0,style:{flex:3,display:"flex",flexDirection:"column",backgroundColor:"var(--neko-main-color)"}},React.createElement(s.z,{className:"primary",title:z?ye<_.length?`${ye} of ${_.length} Chunks`:`${_.length} Chunks`:"Upload PDF",style:{flex:1,display:"flex",flexDirection:"column"}},z?React.createElement(React.Fragment,null,oe.isActive&&React.createElement(u.V,{style:{marginBottom:15}},React.createElement(m.j,{busy:!oe.justStopped,value:oe.progress,max:oe.total,status:oe.isPreparing?"Preparing embeddings...":oe.isStopping?"Please wait...":oe.justStopped?"Stopped":void 0,style:{width:"100%"},variant:oe.variant,onStopClick:oe.justStopped?null:oe.stop})),!oe.isActive&&100===oe.percentage&&React.createElement(r.X,{variant:"success",style:{marginBottom:15},onClose:oe.reset},"Successfully created ",oe.progress," ",1===oe.progress?"embedding":"embeddings"),!oe.isActive&&oe.progress>0&&oe.percentage<100&&React.createElement(r.X,{variant:"info",style:{marginBottom:15},onClose:oe.reset},"Stopped after creating ",oe.progress," of ",oe.total," embeddings"),W&&Z&&React.createElement(React.Fragment,null,React.createElement(m.j,{busy:!0,value:0,text:Z}),React.createElement(o.g,null)),React.createElement("div",{style:{flex:1,minHeight:0,overflowY:"auto",overflowX:"hidden"}},_.map((e=>React.createElement(C,{key:e.id,chunk:e,onToggle:Ce,onUpdateTitle:xe,onGenerateTitle:ve,isChunkBusy:ae.has(e.id),isAnyChunkBusy:ae.size>0,isGeneratingTitles:Q,isUploadingEmbeddings:W,colors:w}))))):React.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column"}},React.createElement(c.s,{p:!0,style:{marginBottom:20}},"Select a PDF file to extract its content and create embeddings. The content will be intelligently chunked for optimal AI processing."),React.createElement(d.Z,{accept:".pdf",onSelectFiles:e=>{e&&e.length>0&&Re({target:{files:e}})},disabled:W,style:{marginBottom:20,background:"#e9f5fc"}},React.createElement("div",{style:{padding:40,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center"}},React.createElement(g.z,{icon:"file-upload",width:48,color:w.grey,style:{marginBottom:15}}))),React.createElement(a.M,{fullWidth:!0,className:"primary",onClick:()=>{var e;return null===(e=P.current)||void 0===e?void 0:e.click()},disabled:W,style:{height:50,fontSize:16}},"Select PDF"),W&&React.createElement(React.Fragment,null,React.createElement(o.g,null),React.createElement(m.j,{busy:!0,value:V,text:q>0?`Processing page ${q}...`:"Loading PDF..."}))))),React.createElement(i.Y,{minimal:!0,style:{flex:1,marginLeft:10,backgroundColor:"var(--neko-main-color)"}},React.createElement(s.z,{className:"primary",title:"Document Info"},z?React.createElement(React.Fragment,null,React.createElement("div",{style:{marginBottom:5,fontWeight:"bold"}},z.fileName),React.createElement("div",{style:{fontSize:12,color:w.grey}},z.fullText.length.toLocaleString()," characters (",z.numPages," pages)")):React.createElement(c.s,{small:!0,style:{color:w.grey}},"No PDF loaded")),React.createElement(o.g,{tiny:!0}),z&&React.createElement(React.Fragment,null,React.createElement(s.z,{className:"primary",title:React.createElement("div",{style:{display:"flex",alignItems:"center",gap:8}},React.createElement("span",null,"Titles"),React.createElement(a.M,{rounded:!0,icon:"tools",className:ce?"success":"primary",onClick:()=>se(!0),title:"Additional Instructions"}))},React.createElement("p",{style:{fontSize:12,color:w.grey,marginBottom:10}},"Better titles make embeddings easier to identify in the UI. Edit them manually or generate individually. This doesn't affect search or retrieval quality."),React.createElement(a.M,{fullWidth:!0,className:"primary",ai:!0,onClick:async()=>{ee(!0),ne(!1),le.current=!1;try{for(let e=0;e<_.length;e++){const t=_[e];if(!t.enabled)continue;if(le.current){console.log("[PDF Import] Stopping title generation after current chunk");break}re((e=>new Set(e).add(t.id)));let n=0;if(e>0&&pe>0){const e=Math.floor(t.content.length*(pe/100));n=Math.min(e,t.content.length/4)}let l=`Create a concise title (max 50 chars) for this text:\n\n${t.content.substring(n,n+1024)}`;ce&&(l+=`\n\nAdditional instructions: ${ce}`),l+="\n\nReply with ONLY the title:";const a=await(0,y.IU)(`${x.y0}/ai/completions`,{method:"POST",nonce:x.ok,json:{message:l,scope:"embeddings-title"}});if(a.success&&a.data){const e=a.data.trim().replace(/["']/g,"").substring(0,60);xe(t.id,e)}re((e=>{const n=new Set(e);return n.delete(t.id),n}))}}catch(e){console.error("[PDF Import] Error generating titles:",e)}finally{ee(!1),ne(!1),le.current=!1,re(new Set)}},onStopClick:te?null:()=>{ne(!0),le.current=!0},disabled:!z||0===ye||ae.size>0||Q||W,isBusy:Q,style:{height:40}},"Generate")),React.createElement(o.g,{tiny:!0})),React.createElement(s.z,{className:"primary",title:"Chunking"},React.createElement("p",{style:{fontSize:12,color:w.grey,marginBottom:15}},"Splits your PDF into smaller pieces to create searchable embeddings. Default settings work well for most cases."),React.createElement("div",{style:{marginBottom:20}},React.createElement("label",{style:{fontWeight:"bold",display:"block"}},"Density"),React.createElement(h.$,{min:1,max:5,step:1,value:ge,recommended:3,marks:[1,2,3,4,5],onChange:e=>me(e),onFinalChange:async e=>{if(z){if(5===e&&z.fullText.length>1e5){const e=Math.ceil(z.fullText.length/800);if(!confirm("⚠️ Warning: Highest density will create many small chunks.\n\nYour PDF has "+Math.round(z.fullText.length/1e3)+"k characters.\nThis will create approximately "+e+" chunks.\n\nProcessing may take a moment. Consider using 'High' density for faster processing.\n\nDo you still want to proceed?"))return void me(4)}await be(e,ue,pe)}},labelFormatter:e=>({1:"Lowest",2:"Low",3:"Medium",4:"High",5:"Highest"}[e]),formatValue:e=>({1:"~8000 chars",2:"~4000 chars",3:"~2000 chars",4:"~1600 chars",5:"~800 chars"}[e]),disabled:!z||W||Q,description:"Higher density creates more, smaller chunks."})),React.createElement("div",null,React.createElement("label",{style:{fontWeight:"bold",display:"block"}},"Overlap"),React.createElement(h.$,{min:0,max:25,step:5,value:pe,recommended:15,marks:[0,5,10,15,20,25],onChange:e=>fe(e),onFinalChange:async e=>{z&&await be(ge,ue,e)},formatValue:e=>`${e}%`,disabled:!z||W||Q,description:"Overlap improves context between chunks."})))),React.createElement(l.n,{title:"Additional Instructions",size:"small",isOpen:ie,onRequestClose:()=>se(!1),customButtons:React.createElement(React.Fragment,null,React.createElement(a.M,{className:"danger",onClick:()=>se(!1)},"Cancel"),ce&&React.createElement(a.M,{onClick:()=>{de(""),localStorage.removeItem("mwai_pdf_title_instructions"),se(!1)}},"Clear"),React.createElement(a.M,{className:"primary",onClick:()=>{ce?localStorage.setItem("mwai_pdf_title_instructions",ce):localStorage.removeItem("mwai_pdf_title_instructions"),se(!1)}},"Save")),content:React.createElement("div",null,React.createElement(c.s,{p:!0,style:{marginBottom:15}},"Provide additional instructions for title generation. These will be included when generating titles for chunks."),React.createElement(p.m,{value:ce,onChange:de,placeholder:"e.g., Use academic style, Include chapter numbers, Focus on main concepts, etc.",rows:5,style:{width:"100%"}}),React.createElement(c.s,{small:!0,style:{marginTop:10,color:w.grey}},"⚠️ These instructions are stored locally in your browser and will be cleared after a while."))}))}));A.displayName="PDFImportView";const H=A,{useState:G}=wp.element,_=({modal:e,setModal:t,onAddEmbedding:n,environment:i})=>{const[s,c]=G(null),[d,g]=G(null),[m,u]=G(!1),h=()=>{t(null),g(null),u(!1),null!=s&&s.clearPDF&&s.clearPDF()};return React.createElement(l.n,{title:"Import from PDF",size:"full-size",style:{backgroundColor:"var(--neko-main-color)"},isOpen:"pdf-import"===(null==e?void 0:e.type),onRequestClose:h,customButtons:React.createElement(React.Fragment,null,React.createElement(a.M,{className:"danger",onClick:h,disabled:m},"Close"),React.createElement(a.M,{onClick:()=>{null!=s&&s.clearPDF&&s.clearPDF()},disabled:m||!(null!=s&&s.pdfData)},"Close PDF"),React.createElement(a.M,{className:"primary",onClick:()=>{null!=s&&s.handleUploadEmbeddings&&s.handleUploadEmbeddings()},disabled:m||!(null!=s&&s.pdfData)||!(null!=s&&s.enabledCount),progress:null!=s&&s.busy&&(null==s?void 0:s.uploadProgress)>=0?s.uploadProgress:null},null!=s&&s.busy&&(null==s?void 0:s.uploadProgress)>=0?"Creating Embeddings...":"Create Embeddings")),content:React.createElement(React.Fragment,null,d&&React.createElement(React.Fragment,null,React.createElement(r.X,{variant:"danger"},d),React.createElement(o.g,null)),React.createElement("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column"}},React.createElement(H,{ref:c,onAddEmbedding:n,environment:i,onClose:h,onError:g,onBusyChange:u}))),contentStyle:{margin:"0 -15px",padding:"10px 15px",height:"100%",boxSizing:"border-box",display:"flex",flexDirection:"column",backgroundColor:"var(--neko-main-color)"}})}}}]);